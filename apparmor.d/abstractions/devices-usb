# apparmor.d - Full set of apparmor profiles
# Copyright (C) 2021 Mikhail Morfikov
# Copyright (C) 2021-2024 Alexandre Pujol <alexandre@pujol.io>
# SPDX-License-Identifier: GPL-2.0-only

# Allow raw access to all connected USB devices

  abi <abi/4.0>,

  include <abstractions/devices-usb-read>

  @{PROC}/tty/drivers r,

  /dev/bus/usb/@{d}@{d}@{d}/@{d}@{d}@{d} wk,

  # Allow access to all ttyUSB devices too
  /dev/ttyACM@{int} wk,
  /dev/ttyUSB@{int} wk,

  # Allow raw access to USB printers (i.e. for receipt printers in POS systems).
  /dev/usb/lp@{int} wk,

  include if exists <abstractions/devices-usb.d>

# vim:syntax=apparmor
