# apparmor.d - Full set of apparmor profiles
# Copyright (C) 2016 Canonical Ltd
# Copyright (C) 2025 Alexandre Pujol <alexandre@pujol.io>
# SPDX-License-Identifier: GPL-2.0-only

# Allows domain, record, service, and service type browsing as well as address,
# host and service resolving

  abi <abi/4.0>,

  include <abstractions/bus/system/org.freedesktop.Avahi.Server>

  include <abstractions/bus/system/org.freedesktop.Avahi.AddressResolver>
  include <abstractions/bus/system/org.freedesktop.Avahi.DomainBrowser>
  include <abstractions/bus/system/org.freedesktop.Avahi.HostNameResolver>
  include <abstractions/bus/system/org.freedesktop.Avahi.RecordBrowser>
  include <abstractions/bus/system/org.freedesktop.Avahi.ServiceBrowser>
  include <abstractions/bus/system/org.freedesktop.Avahi.ServiceResolver>
  include <abstractions/bus/system/org.freedesktop.Avahi.ServiceTypeBrowser>

  @{run}/avahi-daemon/socket rw,

  include if exists <abstractions/avahi-observe.d>

# vim:syntax=apparmor
